<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Musician's Practice Toolkit</title>
    <script src="https://unpkg.com/wavesurfer.js@7"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>üéµ Musician's Practice Toolkit</h1>


<!-- DRONE -->
<div class="card">
    <h2>Drone Machine</h2>
    <div class="drone-section">
        <div>
            <span class="selector-label">1. Root Note</span>
            <div class="root-grid" id="rootGrid"></div>
        </div>
        <div>
            <span class="selector-label">2. Chord Intervals</span>
            <div class="interval-grid" id="intervalGrid"></div>
        </div>
        <div class="settings-bar">
            <div class="drone-row">
                <div class="control-group">
                    <span class="selector-label">A Ref</span>
                    <div class="stepper">
                        <button class="stepper-btn" id="droneRefMinus">‚àí</button>
                        <span class="stepper-val" id="droneRefVal">440</span>
                        <button class="stepper-btn" id="droneRefPlus">+</button>
                    </div>
                </div>
                <div class="control-group">
                    <span class="selector-label">Octave</span>
                    <div class="stepper">
                        <button class="stepper-btn" id="droneOctaveMinus">‚àí</button>
                        <span class="stepper-val" id="droneOctaveVal">4</span>
                        <button class="stepper-btn" id="droneOctavePlus">+</button>
                    </div>
                    <input type="hidden" id="droneOctave" value="4" min="1" max="6">
                </div>
            </div>
            <div class="drone-row">
                <span class="selector-label">Volume</span>
                <div class="vol-row"><span style="font-size:0.85rem;">üîà</span><input type="range" id="droneVolume" min="0" max="1" step="0.05" value="0.7"><span style="font-size:0.85rem;">üîä</span></div>
            </div>
            <div class="drone-row">
                <div class="control-group">
                    <span class="selector-label">Tuning</span>
                    <div class="switch-ui" id="tuningSwitch">
                        <button data-val="just" class="active">JUST</button>
                        <button data-val="equal">ET</button>
                    </div>
                </div>
                <div class="control-group">
                    <span class="selector-label">Wave</span>
                    <div class="switch-ui" id="colorSwitch">
                        <button data-val="sine" class="active">SINE</button>
                        <button data-val="triangle">TRI</button>
                    </div>
                </div>
            </div>
            <div class="drone-row">
                <button id="droneToggle" class="main-action" style="flex:1;">üéµ Start Drone</button>
                <button id="droneClear" class="secondary" style="flex:1;">üßπ Clear</button>
            </div>
        </div>
        <div>
            <button class="details-btn" id="detailsToggle">üî¨ Show Details</button>
            <div id="debug-console" style="display:none;"></div>
        </div>
    </div>
</div>

<!-- METRONOME -->
<div class="card" id="metro-card">
    <h2>Metronome</h2>
    <div class="metro-layout">
        <div class="wheel-col">
            <div class="wheel-row">
                <div class="wheel-and-adj">
                    <div class="wheel-outer">
                        <div class="bpm-container">
                            <div id="bpm-display">120</div>
                            <input type="number" id="bpm-input" min="40" max="280" inputmode="numeric">
                            <div id="bpm-label">BPM</div>
                        </div>
                        <div id="wheel"></div>
                    </div>
                    <div class="bpm-adj">
                        <button class="adj-btn" id="bpmMinus">‚àí</button>
                        <span style="font-size:0.68rem;color:var(--text-muted);">fine adjust</span>
                        <button class="adj-btn" id="bpmPlus">+</button>
                    </div>
                </div>
                <div class="start-tap-col">
                    <button id="metroStartBtn" class="main-action metro-start-btn">‚ñ∂<br>Start</button>
                    <button id="tapBtn" class="secondary metro-tap-btn">üëÜ<br>Tap</button>
                </div>
            </div>
        </div>
        <div class="metro-controls">
            <div class="settings-bar">
                <div>
                    <span class="selector-label">Time Signature</span>
                    <div class="ts-input-row">
                        <input type="text" id="tsInput" class="ts-text-input" inputmode="text" autocomplete="off" spellcheck="false" placeholder="4/4">
                        <span class="ts-hint">e.g. 4/4, 3/4, 6/8, 7/8</span>
                    </div>
                </div>
                <div>
                    <span class="selector-label">Subdivision</span>
                    <div class="seg-ctrl" id="subdivCtrl">
                        <button data-val="1" class="active">‚ô© Beat</button>
                        <button data-val="2">‚ô™ 8th</button>
                        <button data-val="3">‚ô©¬≥ Trip</button>
                        <button data-val="4">‚ô¨ 16th</button>
                    </div>
                </div>
                <div>
                    <span class="selector-label">Click Sound</span>
                    <div class="seg-ctrl" id="clickSoundCtrl">
                        <button data-val="clave" class="active">Clave</button>
                        <button data-val="click">Click</button>
                        <button data-val="rim">Rim</button>
                        <button data-val="cowbell">Cowbell</button>
                    </div>
                </div>
                <div id="metro-vol-row">
                    <span class="selector-label">Volume</span>
                    <div class="vol-row"><span style="font-size:0.85rem;">üîá</span><input type="range" id="metroVolume" min="0" max="1" step="0.05" value="0.7"><span style="font-size:0.85rem;">üîä</span></div>
                </div>
                <div>
                    <span class="selector-label">Output</span>
                    <div class="mode-row">
                        <button id="soundToggle" class="btn-toggle" style="flex:1;">üîî Sound</button>
                        <button id="lightToggle" class="btn-toggle" style="flex:1;">‚ö° Light</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- AUDIO MEMOS -->
<div class="card">
    <h2>Audio Memos</h2>
    <div style="text-align:center;">
        <button id="recordToggle" class="main-action">üéôÔ∏è Start Recording</button>
    </div>
    <div id="rec-status" style="margin-top:0.75rem;height:20px;color:var(--primary);font-weight:700;font-size:0.8rem;text-align:center;"></div>
    <canvas id="liveWaveform" height="80" style="width:100%;display:none;border-radius:8px;background:rgba(0,0,0,0.5);margin-top:0.75rem;"></canvas>
    <div id="memoList"></div>
</div>

<!-- CHROMATIC TUNER -->
<div class="card" id="tuner-card">
    <h2>Chromatic Tuner</h2>
    <div class="tuner-body">
        <div class="tuner-note-display">
            <div class="tuner-note-name" id="tunerNoteName">‚Äî</div>
            <div class="tuner-cents" id="tunerCentsDisplay"></div>
        </div>
        <div class="tuner-meter-wrap">
            <div class="tuner-meter-track">
                <div class="tuner-meter-fill" id="tunerMeterFill"></div>
                <div class="tuner-meter-center"></div>
                <div class="tuner-tick" style="left:0%"></div>
                <div class="tuner-tick" style="left:25%"></div>
                <div class="tuner-tick" style="left:50%"></div>
                <div class="tuner-tick" style="left:75%"></div>
                <div class="tuner-tick" style="left:100%"></div>
            </div>
            <div class="tuner-meter-labels">
                <span>-50</span><span>-25</span><span>0</span><span>+25</span><span>+50</span>
            </div>
        </div>
        <div class="settings-bar">
            <div class="drone-row">
                <div class="control-group">
                    <span class="selector-label">Tuner</span>
                    <button id="tunerToggle" class="main-action">üé§ Start Tuner</button>
                </div>
                <div class="control-group">
                    <span class="selector-label">A Ref</span>
                    <div class="stepper">
                        <button class="stepper-btn" id="tunerRefMinus">‚àí</button>
                        <span class="stepper-val" id="tunerRefVal">440</span>
                        <button class="stepper-btn" id="tunerRefPlus">+</button>
                    </div>
                </div>
            </div>
            <div id="tunerStatus" class="tuner-status"></div>
        </div>
    </div>
</div>

<!-- MUSICAL DICTIONARY -->
<div class="card">
    <h2>Musical Dictionary</h2>
    <input type="text" id="dictSearch" class="dict-search" placeholder="Search terms‚Ä¶" autocomplete="off" spellcheck="false" inputmode="text">
    <div id="dictResults" class="dict-results"></div>
</div>

<script type="module" src="./app.js"></script>
<div id="viewport-flash"></div>
</body>
</html>
