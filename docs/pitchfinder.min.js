var NJ=Object.create;var{getPrototypeOf:kJ,defineProperty:i,getOwnPropertyNames:CJ}=Object;var FJ=Object.prototype.hasOwnProperty;var RJ=(W,Z,Q)=>{Q=W!=null?NJ(kJ(W)):{};let z=Z||!W||!W.__esModule?i(Q,"default",{value:W,enumerable:!0}):Q;for(let G of CJ(W))if(!FJ.call(z,G))i(z,G,{get:()=>W[G],enumerable:!0});return z};var M=(W,Z)=>()=>(Z||W((Z={exports:{}}).exports,Z),Z.exports);var JJ=M((b)=>{var m=b&&b.__assign||function(){return m=Object.assign||function(W){for(var Z,Q=1,z=arguments.length;Q<z;Q++){Z=arguments[Q];for(var G in Z)if(Object.prototype.hasOwnProperty.call(Z,G))W[G]=Z[G]}return W},m.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0});var IJ={threshold:0.1,sampleRate:44100,probabilityThreshold:0.1};function VJ(W){if(W===void 0)W={};var Z=m(m({},IJ),W),Q=Z.threshold,z=Z.sampleRate,G=Z.probabilityThreshold;return function(V){var J;for(J=1;J<V.length;J*=2);J/=2;var w=J/2,q=new Float32Array(w),k=0,H;for(var K=0;K<w;K++)q[K]=0;for(var K=1;K<w;K++)for(var C=0;C<w;C++){var R=V[C]-V[C+K];q[K]+=R*R}q[0]=1,q[1]=1;var E=0;for(var K=1;K<w;K++)E+=q[K],q[K]*=K/E;for(H=2;H<w;H++)if(q[H]<Q){while(H+1<w&&q[H+1]<q[H])H++;k=1-q[H];break}if(H===w||q[H]>=Q)return null;if(k<G)return null;var N,$,O;if(H<1)$=H;else $=H-1;if(H+1<w)O=H+1;else O=H;if($===H)if(q[H]<=q[O])N=H;else N=O;else if(O===H)if(q[H]<=q[$])N=H;else N=$;else{var Y=q[$],U=q[H],X=q[O];N=H+(X-Y)/(2*(2*U-X-Y))}return z/N}}b.YIN=VJ});var KJ=M((B)=>{var p=B&&B.__assign||function(){return p=Object.assign||function(W){for(var Z,Q=1,z=arguments.length;Q<z;Q++){Z=arguments[Q];for(var G in Z)if(Object.prototype.hasOwnProperty.call(Z,G))W[G]=Z[G]}return W},p.apply(this,arguments)};Object.defineProperty(B,"__esModule",{value:!0});var EJ={sampleRate:44100,minFrequency:82,maxFrequency:1000,ratio:5,sensitivity:0.1};function TJ(W){if(W===void 0)W={};var Z=p(p({},EJ),W),Q=Z.sampleRate,z=Z.minFrequency,G=Z.maxFrequency,F=Z.sensitivity,V=Z.ratio,J=[],w=Math.ceil(Q/z),q=Math.floor(Q/G);return function(H){var K=H.length,C=0,R=1/0,E=-1/0,N,$,O,Y,U,X,I,T;for(Y=0;Y<K;Y++)if(q<=Y&&Y<=w){for(I=0,T=Y,C=0,N=[],$=[];I<K-Y;C++,T++,I++)N[C]=H[I],$[C]=H[T];var j=N.length;O=[];for(X=0;X<j;X++)O[X]=N[X]-$[X];var L=0;for(X=0;X<j;X++)L+=Math.abs(O[X]);J[Y]=L}for(U=q;U<w;U++){if(J[U]<R)R=J[U];if(J[U]>E)E=J[U]}var y=Math.round(F*(E-R)+R);for(U=q;U<=w&&J[U]>y;U++);var _=q/2;R=J[U];var v=U;for(Y=U-1;Y<U+_&&Y<=w;Y++)if(J[Y]<R)R=J[Y],v=Y;if(Math.round(J[v]*V)<E)return Q/v;else return null}}B.AMDF=TJ});var ZJ=M((A)=>{var d=A&&A.__assign||function(){return d=Object.assign||function(W){for(var Z,Q=1,z=arguments.length;Q<z;Q++){Z=arguments[Q];for(var G in Z)if(Object.prototype.hasOwnProperty.call(Z,G))W[G]=Z[G]}return W},d.apply(this,arguments)};Object.defineProperty(A,"__esModule",{value:!0});var QJ={sampleRate:44100};function PJ(W){if(W===void 0)W=QJ;var Z=d(d({},QJ),W),Q=Z.sampleRate;return function(G){var F=G.length,V=0,J,w,q,k;for(J=0;J<F;J++)k=G[J],V+=k*k;if(V=Math.sqrt(V/F),V<0.01)return-1;var H=0,K=F-1,C=0.2;for(J=0;J<F/2;J++)if(Math.abs(G[J])<C){H=J;break}for(J=1;J<F/2;J++)if(Math.abs(G[F-J])<C){K=F-J;break}var R=G.slice(H,K),E=R.length,N=Array(E).fill(0);for(J=0;J<E;J++)for(w=0;w<E-J;w++)N[J]=N[J]+R[w]*R[w+J];q=0;while(N[q]>N[q+1])q++;var $=-1,O=-1;for(J=q;J<E;J++)if(N[J]>$)$=N[J],O=J;var Y=O,U=N[Y-1],X=N[Y],I=N[Y+1],T=(U+I-2*X)/2,j=(I-U)/2;if(T)Y=Y-j/(2*T);return Q/Y}}A.ACF2PLUS=PJ});var $J=M((x)=>{var r=x&&x.__assign||function(){return r=Object.assign||function(W){for(var Z,Q=1,z=arguments.length;Q<z;Q++){Z=arguments[Q];for(var G in Z)if(Object.prototype.hasOwnProperty.call(Z,G))W[G]=Z[G]}return W},r.apply(this,arguments)};Object.defineProperty(x,"__esModule",{value:!0});var jJ=6,vJ=3000,yJ=3,LJ=0.75,DJ={sampleRate:44100};function MJ(W){if(W===void 0)W={};var Z=r(r({},DJ),W),Q=Z.sampleRate;return function(G){var F=[],V=[],J=G.length,w=null,q=0,k=0,H=0;for(var K=0;K<J;K++){var C=G[K];q=q+C,H=Math.max(H,C),k=Math.min(k,C)}q/=J,k-=q,H-=q;var R=H>-1*k?H:-1*k,E=R*LJ,N=0,$=-1,O=G.length,Y,U,X;while(!0){if(Y=~~(Q/(Math.pow(2,N)*vJ)),O<2)break;var I=void 0,T=-1000,j=-1e6,L=-1e6,y=!1,_=!1;X=0,U=0;for(var K=2;K<O;K++){var v=G[K]-q,u=G[K-1]-q;if(u<=0&&v>0)y=!0;if(u>=0&&v<0)_=!0;if(I=v-u,T>-1000){if(_&&T<0&&I>=0){if(Math.abs(v)>=E){if(K>j+Y)F[X++]=K,j=K,_=!1}}if(y&&T>0&&I<=0){if(Math.abs(v)>=E){if(K>L+Y)V[U++]=K,L=K,y=!1}}}T=I}if(X===0&&U===0)break;var a=void 0,g=[];for(var K=0;K<O;K++)g[K]=0;for(var K=0;K<X;K++)for(var P=1;P<yJ;P++)if(K+P<X)a=Math.abs(F[K]-F[K+P]),g[a]+=1;var D=-1,f=-1;for(var K=0;K<O;K++){var c=0;for(var P=-1*Y;P<=Y;P++)if(K+P>=0&&K+P<O)c+=g[K+P];if(c===f){if(K===2*D)D=K}else if(c>f)f=c,D=K}var l=0,t=0;for(var P=-Y;P<=Y;P++)if(D+P>=0&&D+P<J){var s=g[D+P];if(s>0)t+=s,l+=(D+P)*s}if(l/=t,$>-1){if(Math.abs(l*2-$)<=2*Y){w=Q/(Math.pow(2,N-1)*$);break}}if($=l,N++,N>=jJ||O<2)break;var e=G.subarray(0);if(O===g.length)e=new Float32Array(O/2);for(var K=0;K<O/2;K++)e[K]=(G[2*K]+G[2*K+1])/2;G=e,O/=2}return w}}x.DynamicWavelet=MJ});var GJ=M((h)=>{var n=h&&h.__assign||function(){return n=Object.assign||function(W){for(var Z,Q=1,z=arguments.length;Q<z;Q++){Z=arguments[Q];for(var G in Z)if(Object.prototype.hasOwnProperty.call(Z,G))W[G]=Z[G]}return W},n.apply(this,arguments)};Object.defineProperty(h,"__esModule",{value:!0});var SJ={bufferSize:1024,cutoff:0.97,sampleRate:44100};function _J(W){if(W===void 0)W={};var Z=n(n({},SJ),W),Q=Z.bufferSize,z=Z.cutoff,G=Z.sampleRate,F=0.5,V=80,J=new Float32Array(Q),w=new Float32Array(Q),q,k,H=[],K=[],C=[];function R($){var O,Y;w[0]=$[0]*$[0];for(var U=1;U<$.length;U+=1)w[U]=$[U]*$[U]+w[U-1];for(var X=0;X<$.length;X++){O=0,Y=w[$.length-1-X]+w[$.length-1]-w[X];for(var U=0;U<$.length-X;U++)O+=$[U]*$[U+X];J[X]=2*O/Y}}function E($){var O=J[$-1],Y=J[$],U=J[$+1],X=$,I=U+O-2*Y;if(I===0)q=X,k=Y;else{var T=O-U;q=X+T/(2*I),k=Y-T*T/(8*I)}}function N(){var $=0,O=0;while($<(J.length-1)/3&&J[$]>0)$++;while($<J.length-1&&J[$]<=0)$++;if($==0)$=1;while($<J.length-1){if(J[$]>J[$-1]&&J[$]>=J[$+1]){if(O==0)O=$;else if(J[$]>J[O])O=$}if($++,$<J.length-1&&J[$]<=0){if(O>0)H.push(O),O=0;while($<J.length-1&&J[$]<=0)$++}}if(O>0)H.push(O)}return function(O){var Y;H=[],K=[],C=[],R(O),N();var U=-1/0;for(var X=0;X<H.length;X++){var I=H[X];if(U=Math.max(U,J[I]),J[I]>F)E(I),C.push(k),K.push(q),U=Math.max(U,k)}if(K.length){var T=z*U,j=0;for(var X=0;X<C.length;X++)if(C[X]>=T){j=X;break}var L=K[j],y=G/L;if(y>V)Y=y;else Y=-1}else Y=-1;return{probability:U,freq:Y}}}h.Macleod=_J});var WJ=M((S)=>{var o=S&&S.__assign||function(){return o=Object.assign||function(W){for(var Z,Q=1,z=arguments.length;Q<z;Q++){Z=arguments[Q];for(var G in Z)if(Object.prototype.hasOwnProperty.call(Z,G))W[G]=Z[G]}return W},o.apply(this,arguments)};Object.defineProperty(S,"__esModule",{value:!0});S.DEFAULT_FREQUENCIES_PARAMS={tempo:120,quantization:4,sampleRate:44100};function gJ(W,Z){var Q=W.map(function(q){return q(Z)}).filter(function(q){return q!==null}).sort(function(q,k){return q-k});if(Q.length===1)return Q[0];else if(Q.length===2){var z=Q[0],G=Q[1];return z*2>G?Math.sqrt(z*G):z}else{var z=Q[0],G=Q[1],F=Q[Q.length-2],V=Q[Q.length-1],J=z*2>G?Q:Q.slice(1),w=F*2>V?J:J.slice(0,-1);return Math.pow(w.reduce(function(H,K){return H*K},1),1/w.length)}}function bJ(W,Z,Q){if(Q===void 0)Q={};var z=o(o({},S.DEFAULT_FREQUENCIES_PARAMS),Q),G=z.tempo,F=z.quantization,V=z.sampleRate,J=Z.length,w=Math.round(V*60/(F*G)),q;if(Array.isArray(W))q=gJ.bind(null,W);else q=W;var k=[];for(var H=0,K=J-w;H<=K;H+=w){var C=Z.slice(H,H+w),R=q(C);k.push(R)}return k}S.frequencies=bJ});var zJ=M((wJ)=>{Object.defineProperty(wJ,"__esModule",{value:!0});var qJ=JJ();wJ.YIN=qJ.YIN;var HJ=KJ();wJ.AMDF=HJ.AMDF;var YJ=ZJ();wJ.ACF2PLUS=YJ.ACF2PLUS;var UJ=$J();wJ.DynamicWavelet=UJ.DynamicWavelet;var OJ=GJ();wJ.Macleod=OJ.Macleod;var XJ=WJ();wJ.frequencies=XJ.frequencies;wJ.default={YIN:qJ.YIN,AMDF:HJ.AMDF,ACF2PLUS:YJ.ACF2PLUS,DynamicWavelet:UJ.DynamicWavelet,Macleod:OJ.Macleod,frequencies:XJ.frequencies}});var pJ=RJ(zJ(),1);window.Pitchfinder=pJ;
